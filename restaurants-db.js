// 飲食店データベース
const restaurantDatabase = {
    // ファストフード
    "マクドナルド": { tags: ["ファストフード", "ハンバーガー"], aliases: ["マック", "マクド", "McDonald's"] },
    "モスバーガー": { tags: ["ファストフード", "ハンバーガー"], aliases: ["モス", "MOS BURGER"] },
    "ケンタッキー": { tags: ["ファストフード", "チキン"], aliases: ["KFC", "ケンタ"] },
    "バーガーキング": { tags: ["ファストフード", "ハンバーガー"], aliases: ["バーキン", "Burger King"] },
    "フレッシュネスバーガー": { tags: ["ファストフード", "ハンバーガー"], aliases: ["フレッシュネス"] },
    "ロッテリア": { tags: ["ファストフード", "ハンバーガー"], aliases: ["LOTTERIA"] },
    "サブウェイ": { tags: ["ファストフード", "サンドイッチ"], aliases: ["SUBWAY"] },
    
    // 寿司
    "スシロー": { tags: ["寿司", "回転寿司"], aliases: ["すしろー", "SUSHIRO"] },
    "くら寿司": { tags: ["寿司", "回転寿司"], aliases: ["くら", "無添くら寿司"] },
    "はま寿司": { tags: ["寿司", "回転寿司"], aliases: ["はま", "浜寿司"] },
    "かっぱ寿司": { tags: ["寿司", "回転寿司"], aliases: ["かっぱ", "カッパ寿司"] },
    "元気寿司": { tags: ["寿司", "回転寿司"], aliases: ["げんき寿司"] },
    "魚べい": { tags: ["寿司", "回転寿司"], aliases: ["うおべい"] },
    "回転寿司": { tags: ["寿司", "回転寿司"], aliases: ["回転ずし"] },
    "寿司": { tags: ["寿司"], aliases: ["すし", "お寿司", "鮨", "スシ"] },
    "お寿司屋さん": { tags: ["寿司"], aliases: ["寿司屋", "すし屋"] },
    
    // ラーメン
    "一蘭": { tags: ["ラーメン", "とんこつ"], aliases: ["いちらん", "ICHIRAN"] },
    "一風堂": { tags: ["ラーメン", "とんこつ"], aliases: ["いっぷうどう", "IPPUDO"] },
    "天下一品": { tags: ["ラーメン"], aliases: ["天一", "てんかいっぴん"] },
    "幸楽苑": { tags: ["ラーメン", "中華"], aliases: ["こうらくえん"] },
    "日高屋": { tags: ["ラーメン", "中華"], aliases: ["ひだかや"] },
    "ラーメン二郎": { tags: ["ラーメン"], aliases: ["二郎", "じろう"] },
    "博多風龍": { tags: ["ラーメン", "とんこつ"], aliases: ["ふうりゅう"] },
    "ラーメン": { tags: ["ラーメン"], aliases: ["らーめん", "らあめん", "拉麺"] },
    "ラーメン屋": { tags: ["ラーメン"], aliases: ["らーめん屋", "ラーメン店"] },
    
    // ファミレス
    "ガスト": { tags: ["ファミレス", "洋食"], aliases: ["Gusto", "GUSTO"] },
    "サイゼリヤ": { tags: ["ファミレス", "イタリアン"], aliases: ["サイゼ", "Saizeriya"] },
    "ジョナサン": { tags: ["ファミレス", "洋食"], aliases: ["Jonathan's"] },
    "デニーズ": { tags: ["ファミレス", "洋食"], aliases: ["Denny's", "DENNYS"] },
    "ロイヤルホスト": { tags: ["ファミレス", "洋食"], aliases: ["ロイホ", "Royal Host"] },
    "ビッグボーイ": { tags: ["ファミレス", "ハンバーグ"], aliases: ["Big Boy"] },
    "ジョイフル": { tags: ["ファミレス", "洋食"], aliases: ["Joyfull"] },
    "ココス": { tags: ["ファミレス", "洋食"], aliases: ["COCO'S", "Cocos"] },
    "びっくりドンキー": { tags: ["ファミレス", "ハンバーグ"], aliases: ["ドンキー", "ビックリドンキー"] },
    
    // 牛丼・丼物
    "吉野家": { tags: ["牛丼", "和食"], aliases: ["よしのや", "YOSHINOYA"] },
    "すき家": { tags: ["牛丼", "和食"], aliases: ["SUKIYA", "スキヤ"] },
    "松屋": { tags: ["牛丼", "和食"], aliases: ["まつや", "MATSUYA"] },
    "なか卯": { tags: ["牛丼", "和食", "うどん"], aliases: ["なかう", "NAKAU"] },
    "松のや": { tags: ["とんかつ", "和食"], aliases: ["松乃家", "まつのや"] },
    "かつや": { tags: ["とんかつ", "和食"], aliases: ["KATSUYA"] },
    "てんや": { tags: ["天丼", "和食"], aliases: ["天丼てんや", "TENYA"] },
    
    // 焼肉
    "牛角": { tags: ["焼肉"], aliases: ["ぎゅうかく", "GYUKAKU"] },
    "安楽亭": { tags: ["焼肉"], aliases: ["あんらくてい"] },
    "叙々苑": { tags: ["焼肉", "高級"], aliases: ["じょじょえん", "JOJOEN"] },
    "ワンカルビ": { tags: ["焼肉", "食べ放題"], aliases: ["ONE KARUBI", "ワンカル"] },
    "焼肉きんぐ": { tags: ["焼肉", "食べ放題"], aliases: ["焼肉キング", "YAKINIKU KING"] },
    "牛庵": { tags: ["焼肉"], aliases: ["ぎゅうあん"] },
    "焼肉": { tags: ["焼肉"], aliases: ["焼き肉", "やきにく", "ヤキニク"] },
    "焼肉屋": { tags: ["焼肉"], aliases: ["焼き肉屋", "やきにく屋"] },
    
    // イタリアン
    "サイゼリヤ": { tags: ["イタリアン", "ファミレス"], aliases: ["サイゼ", "Saizeriya"] },
    "カプリチョーザ": { tags: ["イタリアン"], aliases: ["Capricciosa"] },
    "ジョリーパスタ": { tags: ["イタリアン", "パスタ"], aliases: ["ジョリパ", "Jolly Pasta"] },
    "五右衛門": { tags: ["イタリアン", "パスタ"], aliases: ["洋麺屋五右衛門", "ごえもん"] },
    "鎌倉パスタ": { tags: ["イタリアン", "パスタ"], aliases: ["かまくらパスタ"] },
    "ピザーラ": { tags: ["ピザ", "イタリアン"], aliases: ["Pizza-La", "PIZZA-LA"] },
    "ドミノピザ": { tags: ["ピザ", "イタリアン"], aliases: ["Domino's", "ドミノ"] },
    "ピザハット": { tags: ["ピザ", "イタリアン"], aliases: ["Pizza Hut", "PIZZA HUT"] },
    "ピザ": { tags: ["ピザ", "イタリアン"], aliases: ["pizza", "ピッツァ"] },
    "パスタ": { tags: ["パスタ", "イタリアン"], aliases: ["pasta", "スパゲッティ"] },
    "イタリアン": { tags: ["イタリアン"], aliases: ["イタリア料理", "イタリアンレストラン"] },
    
    // カフェ
    "スターバックス": { tags: ["カフェ", "コーヒー"], aliases: ["スタバ", "Starbucks", "STARBUCKS"] },
    "ドトール": { tags: ["カフェ", "コーヒー"], aliases: ["DOUTOR", "ドトールコーヒー"] },
    "タリーズ": { tags: ["カフェ", "コーヒー"], aliases: ["TULLY'S", "タリーズコーヒー"] },
    "コメダ珈琲": { tags: ["カフェ", "喫茶店"], aliases: ["コメダ", "KOMEDA"] },
    "星乃珈琲": { tags: ["カフェ", "喫茶店"], aliases: ["ほしのコーヒー", "星乃珈琲店"] },
    "サンマルク": { tags: ["カフェ", "ベーカリー"], aliases: ["サンマルクカフェ", "Saint Marc"] },
    "ベローチェ": { tags: ["カフェ", "コーヒー"], aliases: ["Veloce", "VELOCE"] },
    
    // 中華
    "バーミヤン": { tags: ["中華", "ファミレス"], aliases: ["Bamiyan", "BAMIYAN"] },
    "餃子の王将": { tags: ["中華", "餃子"], aliases: ["王将", "おうしょう", "OHSHO"] },
    "大阪王将": { tags: ["中華", "餃子"], aliases: ["OSAKA OHSHO"] },
    "王将": { tags: ["中華", "餃子"], aliases: ["おうしょう", "餃子の王将"] },
    "日高屋": { tags: ["中華", "ラーメン"], aliases: ["ひだかや", "HIDAKAYA"] },
    "中華料理屋": { tags: ["中華"], aliases: ["中華", "中国料理"] },
    
    // うどん・そば
    "丸亀製麺": { tags: ["うどん", "和食"], aliases: ["まるがめ", "MARUGAME"] },
    "はなまるうどん": { tags: ["うどん", "和食"], aliases: ["はなまる", "HANAMARU"] },
    "富士そば": { tags: ["そば", "和食"], aliases: ["ふじそば", "FUJI SOBA"] },
    "ゆで太郎": { tags: ["そば", "和食"], aliases: ["ゆでたろう", "YUDETARO"] },
    "小諸そば": { tags: ["そば", "和食"], aliases: ["こもろそば", "KOMORO"] },
    
    // カレー
    "CoCo壱番屋": { tags: ["カレー"], aliases: ["ココイチ", "CoCo壱", "ココ壱"] },
    "ゴーゴーカレー": { tags: ["カレー"], aliases: ["GO!GO!CURRY", "55カレー"] },
    "カレー": { tags: ["カレー"], aliases: ["curry", "カレーライス"] },
    "カレー屋": { tags: ["カレー"], aliases: ["カレーハウス", "カレー店"] },
    
    // 山梨県の飲食店チェーン
    "桔梗屋": { tags: ["和菓子", "スイーツ", "山梨"], aliases: ["ききょうや", "桔梗信玄餅", "KIKYOYA"] },
    "甲州ワインビーフ": { tags: ["焼肉", "山梨", "高級"], aliases: ["甲州牛", "ワインビーフ"] },
    "ほうとう不動": { tags: ["ほうとう", "山梨", "和食"], aliases: ["不動", "FUDO", "ふどう"] },
    "小作": { tags: ["ほうとう", "山梨", "和食"], aliases: ["こさく", "KOSAKU"] },
    "浅間茶屋": { tags: ["ほうとう", "山梨", "和食"], aliases: ["あさまちゃや"] },
    "甲州夢小路": { tags: ["山梨", "観光地", "複合施設"], aliases: ["夢小路", "ゆめこうじ"] },
    "シャトレーゼ": { tags: ["スイーツ", "ケーキ", "山梨", "アイス"], aliases: ["Chateraise", "シャトレーゼ本店"] },
    "清月": { tags: ["和菓子", "スイーツ", "山梨"], aliases: ["せいげつ", "イタリアンロール"] },
    "金精軒": { tags: ["和菓子", "スイーツ", "山梨"], aliases: ["きんせいけん", "信玄餅"] },
    "澤田屋": { tags: ["和菓子", "スイーツ", "山梨"], aliases: ["さわだや", "くろ玉"] },
    "奥藤本店": { tags: ["ほうとう", "山梨", "和食"], aliases: ["おくとう", "奥藤"] },
    "みはらし": { tags: ["ほうとう", "山梨", "和食"], aliases: ["河口湖みはらし"] },
    "富士桜高原麦酒": { tags: ["ビール", "山梨", "地ビール"], aliases: ["富士桜", "ふじざくら"] },
    "丸亀製麺": { tags: ["うどん", "和食"], aliases: ["まるがめ", "MARUGAME"] },
    "やまなし": { tags: ["フルーツ", "山梨", "デザート"], aliases: ["山梨県産", "フルーツ王国"] },
    "信玄鶏": { tags: ["鶏料理", "山梨", "焼き鳥"], aliases: ["しんげんどり"] },
    "甲府鳥もつ煮": { tags: ["B級グルメ", "山梨", "居酒屋"], aliases: ["鳥もつ煮", "とりもつ煮"] },
    "吉田うどん": { tags: ["うどん", "山梨", "B級グルメ"], aliases: ["よしだうどん", "富士吉田うどん"] },
    "コメダ珈琲": { tags: ["カフェ", "喫茶店"], aliases: ["コメダ", "KOMEDA"] },
    "スターバックス": { tags: ["カフェ", "コーヒー"], aliases: ["スタバ", "Starbucks", "STARBUCKS"] },
    
    // 定食・和食チェーン
    "大戸屋": { tags: ["定食", "和食", "ファミレス"], aliases: ["おおとや", "OOTOYA"] },
    "やよい軒": { tags: ["定食", "和食"], aliases: ["やよいけん", "YAYOIKEN"] },
    "ごはんどき": { tags: ["定食", "和食"], aliases: ["ゴハンドキ"] },
    "かつ庵": { tags: ["とんかつ", "定食", "和食"], aliases: ["かつあん"] },
    "新宿さぼてん": { tags: ["とんかつ", "定食"], aliases: ["さぼてん", "SABOTEN"] },
    
    // ラーメンチェーン（追加）
    "リンガーハット": { tags: ["ちゃんぽん", "ラーメン", "長崎"], aliases: ["RINGER HUT", "リンガー"] },
    "丸源ラーメン": { tags: ["ラーメン", "醤油"], aliases: ["まるげん", "MARUGEN"] },
    "来来亭": { tags: ["ラーメン", "京都"], aliases: ["らいらいてい", "RAIRAITEI"] },
    "8番らーめん": { tags: ["ラーメン", "北陸"], aliases: ["ハチバン", "8ban"] },
    "山岡家": { tags: ["ラーメン", "とんこつ"], aliases: ["やまおかや"] },
    
    // 洋食チェーン
    "ブロンコビリー": { tags: ["ステーキ", "洋食", "ファミレス"], aliases: ["BRONCO BILLY", "ブロンコ"] },
    "フォルクス": { tags: ["ステーキ", "洋食", "ファミレス"], aliases: ["VOLKS"] },
    "ペッパーランチ": { tags: ["ステーキ", "洋食"], aliases: ["PEPPER LUNCH", "ペッパー"] },
    "俺のイタリアン": { tags: ["イタリアン", "高級"], aliases: ["俺の"] },
    "俺のフレンチ": { tags: ["フレンチ", "高級"], aliases: ["俺の"] },
    
    // 回転寿司（追加）
    "銚子丸": { tags: ["寿司", "回転寿司"], aliases: ["ちょうしまる"] },
    "すしざんまい": { tags: ["寿司"], aliases: ["SUSHI ZANMAI"] },
    
    // 焼肉チェーン（追加）
    "カルビ大将": { tags: ["焼肉"], aliases: ["かるびたいしょう"] },
    "じゅうじゅうカルビ": { tags: ["焼肉"], aliases: ["ジュウジュウカルビ"] },
    "炭火焼肉たむら": { tags: ["焼肉"], aliases: ["たむら"] },
    
    // 居酒屋チェーン
    "白木屋": { tags: ["居酒屋"], aliases: ["しろきや", "SHIROKIYA"] },
    "魚民": { tags: ["居酒屋", "海鮮"], aliases: ["うおたみ", "UOTAMI"] },
    "笑笑": { tags: ["居酒屋"], aliases: ["わらわら", "WARAWARA"] },
    "和民": { tags: ["居酒屋"], aliases: ["わたみ", "WATAMI"] },
    "つぼ八": { tags: ["居酒屋"], aliases: ["ツボハチ", "TSUBOHACHI"] },
    "土間土間": { tags: ["居酒屋"], aliases: ["どまどま", "DOMADOMA"] },
    "庄や": { tags: ["居酒屋"], aliases: ["しょうや", "SHOYA"] },
    "月の宴": { tags: ["居酒屋"], aliases: ["つきのうたげ"] },
    
    // 海鮮・寿司チェーン
    "磯丸水産": { tags: ["居酒屋", "海鮮"], aliases: ["いそまるすいさん"] },
    "目利きの銀次": { tags: ["居酒屋", "海鮮"], aliases: ["めききのぎんじ"] },
    
    // コンビニエンスストア
    "セブンイレブン": { tags: ["コンビニ"], aliases: ["セブン", "7-Eleven", "7-11", "7イレブン"] },
    "ローソン": { tags: ["コンビニ"], aliases: ["LAWSON"] },
    "ファミリーマート": { tags: ["コンビニ"], aliases: ["ファミマ", "FamilyMart"] },
    "ミニストップ": { tags: ["コンビニ", "アイス"], aliases: ["MINISTOP"] },
    "デイリーヤマザキ": { tags: ["コンビニ"], aliases: ["デイリー", "DAILY YAMAZAKI"] },
    "セイコーマート": { tags: ["コンビニ", "北海道"], aliases: ["セイコマ", "Seicomart"] },
    "ポプラ": { tags: ["コンビニ", "中国四国"], aliases: ["POPLAR"] },
    "スリーエフ": { tags: ["コンビニ"], aliases: ["3F", "Three F"] },
    
    // スーパー（大手）
    "イオン": { tags: ["スーパー", "ショッピングモール"], aliases: ["AEON", "ジャスコ"] },
    "イトーヨーカドー": { tags: ["スーパー", "百貨店"], aliases: ["ヨーカドー", "ITO YOKADO"] },
    "西友": { tags: ["スーパー"], aliases: ["SEIYU"] },
    "ライフ": { tags: ["スーパー"], aliases: ["LIFE"] },
    "マルエツ": { tags: ["スーパー"], aliases: ["Maruetsu"] },
    
    // お好み焼き・たこ焼き・粉もの系
    "お好み焼き本舗": { tags: ["お好み焼き", "粉もの"], aliases: ["本舗", "おこのみやきほんぽ"] },
    "道とん堀": { tags: ["お好み焼き", "粉もの"], aliases: ["どうとんぼり", "DOUTONBORI"] },
    "風月": { tags: ["お好み焼き", "粉もの"], aliases: ["ふうげつ", "FUGETSU"] },
    "たこ焼き道楽": { tags: ["たこ焼き", "粉もの"], aliases: ["道楽", "どうらく"] },
    "くくる": { tags: ["たこ焼き", "粉もの"], aliases: ["KUKURU"] },
    
    // 牛丼系（追加）
    "東京チカラめし": { tags: ["牛丼", "和食", "焼き牛丼"], aliases: ["チカラめし", "ちからめし"] },
    
    // カレー系（追加）
    "カレーハウス": { tags: ["カレー"], aliases: ["カレー屋", "curry house"] },
    "インドカレー": { tags: ["カレー", "インド料理"], aliases: ["インド料理"] },
    "スープカレー": { tags: ["カレー", "スープ"], aliases: ["soup curry"] },
    
    // パン・ベーカリー系
    "ヴィ・ド・フランス": { tags: ["ベーカリー", "パン", "カフェ"], aliases: ["VIE DE FRANCE", "ヴィドフランス"] },
    "アンデルセン": { tags: ["ベーカリー", "パン"], aliases: ["ANDERSEN"] },
    "神戸屋": { tags: ["ベーカリー", "パン"], aliases: ["KOBEYA", "こうべや"] },
    "パスコ": { tags: ["ベーカリー", "パン"], aliases: ["PASCO", "敷島製パン"] },
    "ヤマザキパン": { tags: ["ベーカリー", "パン"], aliases: ["山崎製パン", "Yamazaki"] },
    "リトルマーメイド": { tags: ["ベーカリー", "パン"], aliases: ["Little Mermaid"] },
    
    // 丼もの系
    "天丼てんや": { tags: ["天丼", "和食"], aliases: ["てんや", "TENYA"] },
    "かつ丼吉兵衛": { tags: ["かつ丼", "とんかつ", "和食"], aliases: ["吉兵衛", "きちべえ"] },
    "親子丼": { tags: ["丼もの", "和食"], aliases: ["oyakodon"] },
    "海鮮丼": { tags: ["丼もの", "海鮮", "和食"], aliases: ["かいせんどん"] },
    
    // 麺類（追加）
    "讃岐製麺": { tags: ["うどん", "和食"], aliases: ["さぬきせいめん", "SANUKI"] },
    "杵屋": { tags: ["うどん", "そば", "和食"], aliases: ["きねや", "KINEYA"] },
    "名代富士そば": { tags: ["そば", "和食"], aliases: ["富士そば", "ふじそば"] },
    "そじ坊": { tags: ["そば", "和食"], aliases: ["SOJIBO", "そじぼう"] },
    "めん処": { tags: ["麺類", "和食"], aliases: ["麺処", "めんどころ"] },
    
    // ドーナツ・スイーツ系（追加）
    "クリスピークリームドーナツ": { tags: ["ドーナツ", "スイーツ"], aliases: ["クリスピー", "Krispy Kreme", "KK"] },
    "ゴディバ": { tags: ["チョコレート", "スイーツ", "高級"], aliases: ["GODIVA"] },
    "ハーゲンダッツ": { tags: ["アイス", "スイーツ", "高級"], aliases: ["Häagen-Dazs", "ハーゲン"] },
    "サーティワンアイスクリーム": { tags: ["アイス", "スイーツ"], aliases: ["31", "Baskin Robbins"] },
    "コールドストーン": { tags: ["アイス", "スイーツ"], aliases: ["Cold Stone Creamery"] },
    
    // その他
    "ミスタードーナツ": { tags: ["スイーツ", "ドーナツ"], aliases: ["ミスド", "Mister Donut"] },
    "31アイスクリーム": { tags: ["スイーツ", "アイス"], aliases: ["サーティワン", "バスキンロビンス", "31"] },
    "シャトレーゼ": { tags: ["スイーツ", "ケーキ"], aliases: ["Chateraise"] },
    "不二家": { tags: ["スイーツ", "ケーキ"], aliases: ["FUJIYA", "ふじや"] },
    "銀だこ": { tags: ["たこ焼き", "粉もの"], aliases: ["築地銀だこ", "ぎんだこ"] },
    "鳥貴族": { tags: ["居酒屋", "焼き鳥"], aliases: ["とりき", "TORIKIZOKU"] },
    "串カツ田中": { tags: ["居酒屋", "串カツ"], aliases: ["串かつ田中", "くしかつ田中"] },
    "いきなりステーキ": { tags: ["ステーキ", "肉料理"], aliases: ["いきなり！ステーキ", "IKINARI STEAK"] },
    "ステーキ宮": { tags: ["ステーキ", "肉料理"], aliases: ["宮", "STEAK MIYA"] },
    "オリジン弁当": { tags: ["弁当", "惣菜"], aliases: ["オリジン", "Origin"] },
    "ほっともっと": { tags: ["弁当"], aliases: ["ホットモット", "HottoMotto"] },
    "ほっかほっか亭": { tags: ["弁当"], aliases: ["ほか弁", "ほっかほか亭"] }
};

// タグの説明
const tagDescriptions = {
    "ファストフード": "🍔",
    "ハンバーガー": "🍔",
    "寿司": "🍣",
    "回転寿司": "🍣",
    "ラーメン": "🍜",
    "ファミレス": "🍽️",
    "イタリアン": "🍝",
    "パスタ": "🍝",
    "ピザ": "🍕",
    "焼肉": "🥩",
    "牛丼": "🍚",
    "和食": "🍱",
    "中華": "🥟",
    "餃子": "🥟",
    "カフェ": "☕",
    "コーヒー": "☕",
    "うどん": "🍜",
    "そば": "🍜",
    "カレー": "🍛",
    "スイーツ": "🍰",
    "居酒屋": "🍺",
    "ステーキ": "🥩",
    "弁当": "🍱",
    "とんかつ": "🍖",
    "天丼": "🍤",
    "チキン": "🍗",
    "サンドイッチ": "🥪",
    "たこ焼き": "🐙",
    "串カツ": "🍢",
    "焼き鳥": "🍗",
    "ドーナツ": "🍩",
    "アイス": "🍦",
    "ケーキ": "🍰",
    "高級": "✨",
    "食べ放題": "♾️",
    // 山梨県関連のタグ
    "山梨": "🏔️",
    "ほうとう": "🍲",
    "和菓子": "🍡",
    "フルーツ": "🍇",
    "B級グルメ": "🏆",
    "地ビール": "🍺",
    "鶏料理": "🍗",
    "観光地": "🗾",
    "複合施設": "🏢",
    "デザート": "🍨",
    "ビール": "🍺",
    
    // 新しいタグ
    "定食": "🍽️",
    "洋食": "🍽️",
    "フレンチ": "🥐",
    "ちゃんぽん": "🍜",
    "海鮮": "🐟",
    "コンビニ": "🏪",
    "スーパー": "🛒",
    "ショッピングモール": "🏬",
    "百貨店": "🏢",
    "長崎": "🏝️",
    "京都": "⛩️",
    "北陸": "🏔️",
    "北海道": "❄️",
    "中国四国": "🌊"
};

// 正規化とタグ取得
function normalizeRestaurantName(input) {
    const normalized = input.trim().toLowerCase();
    
    // データベースを検索
    for (const [name, data] of Object.entries(restaurantDatabase)) {
        // 正式名称と一致
        if (name.toLowerCase() === normalized) {
            return { name, tags: data.tags };
        }
        
        // エイリアスと一致
        if (data.aliases) {
            for (const alias of data.aliases) {
                if (alias.toLowerCase() === normalized) {
                    return { name, tags: data.tags };
                }
            }
        }
    }
    
    // データベースにない場合、キーワードからタグを推測
    const guessedTags = guessTagsFromName(input);
    return { name: input.trim(), tags: guessedTags };
}

// 店舗名からタグを推測
function guessTagsFromName(name) {
    const tags = [];
    const lowerName = name.toLowerCase();
    
    // キーワードマッピング
    const keywordToTag = {
        // 寿司関連
        "寿司": "寿司",
        "すし": "寿司",
        "鮨": "寿司",
        "sushi": "寿司",
        "回転": "回転寿司",
        
        // ラーメン関連
        "ラーメン": "ラーメン",
        "らーめん": "ラーメン",
        "拉麺": "ラーメン",
        "ramen": "ラーメン",
        "とんこつ": "ラーメン",
        "味噌": "ラーメン",
        "醤油": "ラーメン",
        "塩": "ラーメン",
        
        // 焼肉関連
        "焼肉": "焼肉",
        "焼き肉": "焼肉",
        "やきにく": "焼肉",
        "カルビ": "焼肉",
        "ホルモン": "焼肉",
        "牛": "焼肉",
        
        // イタリアン関連
        "ピザ": "ピザ",
        "pizza": "ピザ",
        "マルゲリータ": "ピザ",
        "パスタ": "パスタ",
        "pasta": "パスタ",
        "イタリア": "イタリアン",
        "スパゲ": "パスタ",
        "スパゲッティ": "パスタ",
        "カルボナーラ": "パスタ",
        "ペペロンチーノ": "パスタ",
        "ミートソース": "パスタ",
        
        // カレー関連
        "カレー": "カレー",
        "curry": "カレー",
        "カレーライス": "カレー",
        "カツカレー": "カレー",
        
        // ファストフード関連
        "ポテト": "ファストフード",
        "フライドポテト": "ファストフード",
        "ナゲット": "ファストフード",
        "チキンナゲット": "ファストフード",
        "バーガー": "ハンバーガー",
        "burger": "ハンバーガー",
        "ハンバーガー": "ハンバーガー",
        "チーズバーガー": "ハンバーガー",
        "ビッグマック": "ハンバーガー",
        "チキン": "チキン",
        "フライドチキン": "チキン",
        "から揚げ": "チキン",
        "唐揚げ": "チキン",
        "からあげ": "チキン",
        
        // カフェ関連
        "カフェ": "カフェ",
        "cafe": "カフェ",
        "コーヒー": "コーヒー",
        "coffee": "コーヒー",
        "珈琲": "コーヒー",
        "パンケーキ": "カフェ",
        "サンドイッチ": "カフェ",
        "サンドウィッチ": "カフェ",
        
        // 和食関連
        "うどん": "うどん",
        "きつねうどん": "うどん",
        "天ぷらうどん": "うどん",
        "そば": "そば",
        "蕎麦": "そば",
        "ざるそば": "そば",
        "天ぷらそば": "そば",
        "天ぷら": "和食",
        "てんぷら": "和食",
        "天丼": "和食",
        "とんかつ": "とんかつ",
        "カツ丼": "とんかつ",
        "かつ丼": "とんかつ",
        "ロースカツ": "とんかつ",
        "ヒレカツ": "とんかつ",
        "牛丼": "牛丼",
        "豚丼": "丼もの",
        "親子丼": "丼もの",
        "海鮮丼": "丼もの",
        "丼": "和食",
        "刺身": "和食",
        "さしみ": "和食",
        "しゃぶしゃぶ": "しゃぶしゃぶ",
        "すき焼き": "すき焼き",
        "すきやき": "すき焼き",
        "鍋": "鍋",
        "もつ鍋": "鍋",
        "ちゃんこ鍋": "鍋",
        "おでん": "和食",
        
        // 中華関連
        "中華": "中華",
        "中国": "中華",
        "餃子": "餃子",
        "ギョーザ": "餃子",
        "ぎょうざ": "餃子",
        "シュウマイ": "中華",
        "焼売": "中華",
        "チャーハン": "中華",
        "炒飯": "中華",
        "麻婆": "中華",
        "麻婆豆腐": "中華",
        "エビチリ": "中華",
        "酢豚": "中華",
        "春巻": "中華",
        "春巻き": "中華",
        
        // 洋食関連
        "ステーキ": "ステーキ",
        "steak": "ステーキ",
        "サーロイン": "ステーキ",
        "ハンバーグ": "洋食",
        "オムライス": "洋食",
        "エビフライ": "洋食",
        "コロッケ": "洋食",
        "メンチカツ": "洋食",
        
        // お好み焼き・たこ焼き
        "お好み焼き": "お好み焼き",
        "お好み焼": "お好み焼き",
        "おこのみやき": "お好み焼き",
        "もんじゃ": "お好み焼き",
        "たこ焼き": "たこ焼き",
        "たこ焼": "たこ焼き",
        "タコ焼き": "たこ焼き",
        
        // 鶏料理
        "焼き鳥": "鶏料理",
        "やきとり": "鶏料理",
        "焼鳥": "鶏料理",
        
        // スイーツ・デザート
        "ケーキ": "スイーツ",
        "アイス": "スイーツ",
        "パフェ": "スイーツ",
        "クレープ": "スイーツ",
        "ドーナツ": "スイーツ",
        "スイーツ": "スイーツ",
        "デザート": "スイーツ",
        "タピオカ": "カフェ",
        
        // パン
        "パン": "パン",
        "クロワッサン": "パン",
        "ベーグル": "パン",
        
        // その他
        "居酒屋": "居酒屋",
        "バー": "居酒屋",
        "bar": "居酒屋",
        "弁当": "弁当",
        "おにぎり": "弁当",
        "ファミレス": "ファミレス",
        "レストラン": "ファミレス",
        "サラダ": "ファミレス",
        
        // 山梨関連
        "ほうとう": "ほうとう",
        "信玄": "山梨",
        "甲州": "山梨",
        "甲府": "山梨",
        "山梨": "山梨",
        "富士": "山梨",
        "河口湖": "山梨",
        "吉田": "山梨",
        "桔梗": "山梨",
        "ワイン": "山梨",
        "フルーツ": "フルーツ",
        "もつ煮": "B級グルメ",
        "鳥もつ": "B級グルメ",
        "とりもつ": "B級グルメ"
    };
    
    // キーワードをチェック
    for (const [keyword, tag] of Object.entries(keywordToTag)) {
        if (lowerName.includes(keyword)) {
            if (!tags.includes(tag)) {
                tags.push(tag);
            }
        }
    }
    
    return tags;
}

// オートコンプリート用の候補リスト取得
function getAutocompleteSuggestions(input) {
    if (!input || input.length < 1) return [];
    
    const normalized = input.toLowerCase();
    const suggestions = [];
    
    for (const [name, data] of Object.entries(restaurantDatabase)) {
        // 正式名称で始まる
        if (name.toLowerCase().startsWith(normalized)) {
            suggestions.push(name);
            continue;
        }
        
        // エイリアスで始まる
        if (data.aliases) {
            for (const alias of data.aliases) {
                if (alias.toLowerCase().startsWith(normalized)) {
                    suggestions.push(name);
                    break;
                }
            }
        }
    }
    
    // 重複を削除して最大5件まで返す
    return [...new Set(suggestions)].slice(0, 5);
}